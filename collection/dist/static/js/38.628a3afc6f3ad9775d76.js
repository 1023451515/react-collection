webpackJsonp([38],{NXFA:function(e,t){},fSvb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("6iV/"),s=a.n(i),n=[{label:"公告标题",key:"title",width:"",type:"0"},{label:"公告内容",key:"content",width:"",type:"0"},{label:"发布时间",key:"createTime",width:"250",type:"0"},{label:"公告来源",key:"orgName",width:"250",type:"0"},{label:"附件",key:"",width:"",type:"2",align:""}],o={components:{},data:function(){return{tb:{data:[],fields:n},filterParams:{currentPage:1,pageSize:15},operationBtns:[{name:"发布公告",identifier:"",formName:"createForm",url:"/api/assignee/caseTemplate/addTemplate"},{name:"编辑",identifier:"",dialog:{dialogFormVisible:!1,form:{loanInstitution:"",templateId:"",templateName:"",templateType:"",attachment:{}},rule:{},title:"编辑模板"},formName:"editForm",url:"/api/assignee/caseTemplate/addTemplate"}],dropdownData:{templateType:[]},dialogTitle:"",dialogVisible:!1,result:"",filename:"",fileList:[],postData:{loanInstitution:"",templateId:"",templateName:"",templateType:""},isEdit:!1,loading:!0}},computed:{},created:function(){this.getList()},methods:{getList:function(e){var t=this;this.loading=!0,this.$axios.post("/api/assignee/notice/publishList",this.filterParams).then(function(e){0==e.data.code?t.tb.data=e.data.data.items:t.$util.failCallback(e.data,t),t.loading=!1}).catch(function(e){t.loading=!1})},getdropdownData:function(){var e=this;this.$axios.post("/api/assignee/caseTemplate/getTemplateTypeSelect").then(function(t){0==t.data.code?e.dropdownData.templateType=t.data.data:e.$util.failCallback(t.data,e)}).catch(function(e){})},downLoad:function(e){var t=this;e.accessory.forEach(function(e){t.$axios({method:"post",url:"/api/assignee/notice/downLoad",data:{name:e.name,url:e.url},responseType:"blob"}).then(function(e){if("application/json"!=e.data.type){var a=e.data,i=new Blob([a]),s=decodeURI(e.headers["content-disposition"].split("=")[1]);if("download"in document.createElement("a")){var n=document.createElement("a");n.download=s,n.style.display="none",n.href=URL.createObjectURL(i),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else navigator.msSaveBlob(i,s)}else t.$message({type:"error",message:"下载失败"})})})},goAnnounceSend:function(){this.$router.push({path:"/announce_send"})},goAnnounceDetail:function(e){this.$router.push({path:"/announce_detail"}),this.bus.announceData=e},closeDialog:function(e){this.dialogVisible=!1,this.clearFiles(e),this.$refs.postData.resetFields(),this.getList()},submitUpload:function(){var e=this;0==this.$refs.importCase.fileList.length&&0==this.isEdit?this.$message.warning("请选择文件"):this.isEdit?this.$axios.post("api/assignee/caseTemplate/addTemplate",s.a.stringify(this.postData)).then(function(t){0==t.data.code?(e.$message.success("编辑成功"),e.getList(),e.closeDialog("importCase")):e.$util.failCallback(t.data,e)}).catch(function(e){}):this.$refs.importCase.submit()},beforeUpload:function(e){var t=e.name.lastIndexOf("."),a=e.name.substring(t+1),i="xls"==a||"xlsx"==a,s=e.size/1024/1024<2;return i?s||this.$message.error("上传文件大小不能超过 2MB!"):this.$message.error("只能上传 excel 文件!"),i&&s||(this.file="",this.fileList=[],this.filename=""),i&&s},handleExceed:function(){this.$message.warning("当前限制选择 1 个文件")},handleSuccess_importCase:function(e){0==e.code?(this.$message({type:"success",message:e.msg}),this.closeDialog("importCase")):this.result=e.msg+"!"},handleError:function(e,t,a){},handleChange:function(e){this.isEdit=!1;var t=this.beforeUpload(e);"ready"==e.status&&t&&(this.filename=e.name,this.fileList[0]=e)},clearFiles:function(e){this.filename="",this.result="",this.$refs[e].clearFiles(),this.isEdit=!1}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"content-body"},[a("div",{staticClass:"bd-top"},[a("div",{staticClass:"md clearfix"},[e._m(0),e._v(" "),a("div",{staticClass:"md-right"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.goAnnounceSend}},[e._v("发布公告")])],1)])]),e._v(" "),a("div",{staticClass:"bd-main"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",attrs:{data:e.tb.data,"tooltip-effect":"dark","show-overflow-tooltip":"","max-height":"460","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[a("el-table-column",{attrs:{type:"index"}}),e._v(" "),e._l(e.tb.fields,function(t){return a("el-table-column",{key:t.id,attrs:{align:"left",prop:t.key,label:t.label,width:t.width},scopedSlots:e._u([{key:"default",fn:function(i){return["0"==t.type?[e._v("\n              "+e._s(i.row[i.column.property])+"\n            ")]:e._e(),e._v(" "),"2"==t.type?[i.row.accessory&&1==i.row.accessory.length?a("span",[a("a",{staticClass:"el-button--text el-button--small",staticStyle:{"text-decoration":"underline"},attrs:{href:"javascript:void(0)"},on:{click:function(t){e.downLoad(i.row)}}},[e._v(e._s(i.row.accessory[0].name))])]):e._e(),e._v(" "),i.row.accessory&&i.row.accessory.length>1?a("span",[e._v("\n                  "+e._s(i.row.accessory[0].name)+" 等多个\n              ")]):e._e()]:e._e()]}}])})}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.goAnnounceDetail(t.row)}}},[e._v("查看详情")])],1)]}}])})],2)],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"md-left"},[t("h5",[this._v("公告管理")])])}]};var r=a("vSla")(o,l,!1,function(e){a("NXFA")},null,null);t.default=r.exports}});