webpackJsonp([11],{"1fvw":function(e,t){},OP4f:function(e,t){},hAOA:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("aA9S"),a=i.n(o),r=i("XBA1"),n={name:"visitRuleDialog",data:function(){var e=function(e,t,i){if(t){/^[0-9]{0,}$/.test(t)?i():i(new Error("必须为整数"))}else i()};return{conditionForm:{failRetryTimes:"",retryIntervalTime:"",retryLessBillsec:"",retryTimes:"",ruleName:"",workTime:""},startTime:"",endTime:"",conditionFormrules:{ruleName:[{required:!0,message:"必填项",trigger:"blur"}],failRetryTimes:[{required:!0,message:"必填项",trigger:"blur"},{validator:e,trigger:"blur"}],retryLessBillsec:[{required:!0,message:"必填项",trigger:"blur"},{validator:e,trigger:"blur"}],retryTimes:[{required:!0,message:"必填项",trigger:"blur"},{validator:e,trigger:"blur"}],retryIntervalTime:[{required:!0,message:"必填项",trigger:"blur"},{validator:e,trigger:"blur"}],workTime:[{required:!0,message:"必填项",trigger:"change"}]},workTimes:[{startTime:"",endTime:"",start:"00:00",end:"24:00"}]}},props:{itemData:{type:Object},visible:{type:Boolean}},methods:{dialogCloseHandle:function(){this.$refs.conditionForm.resetFields(),this.$emit("closeDialog")},dialogSubmitHandle:function(){var e=this;this.$refs.conditionForm.validate(function(t){t&&(e.conditionForm.workTime="",e.workTimes.forEach(function(t,i){t&&(e.conditionForm.workTime+=t.startTime+"-"+t.endTime+",")}),e.$axios.post("/api/assignee/proactiveCallManage/createPredictiveCallRule",e.conditionForm).then(function(t){0==t.data.code?(e.$message.success("添加成功"),e.dialogCloseHandle(),e.$emit("refresh")):e.$util.failCallback(t.data,e)}).catch(function(e){}))})},close:function(){this.dialogCloseHandle()},addTime:function(){var e=this.workTimes[this.workTimes.length-1];if(e){if(!e.startTime||"24:00"==e.endTime)return"24:00"!=e.endTime?(this.$message.warning("请先将工作时间填写完整"),!1):(this.$message.warning("无时间段可选"),!1);this.workTimes.push({startTime:"",endTime:"",start:e.endTime,end:"24:00"})}else this.workTimes.push({startTime:"",endTime:"",start:"00:00",end:"24:00"})},removeTime:function(e){if(1==this.workTimes.length)return!1;this.workTimes.splice(e,1),0==this.workTimes.length&&(this.conditionForm.workTime="")},transfromTime:function(e){e&&(this.conditionForm.workTime=e)}},created:function(){this.conditionForm=a()({},this.itemData)}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:"设置外呼规则",visible:e.visible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.close}},[i("el-form",{ref:"conditionForm",staticClass:"dialog-main",attrs:{model:e.conditionForm,"label-width":"150px",size:"small",rules:e.conditionFormrules}},[i("el-form-item",{attrs:{label:"规则名称",prop:"ruleName"}},[i("el-input",{attrs:{clearable:"",placeholder:"请输入外访守则标题"},model:{value:e.conditionForm.ruleName,callback:function(t){e.$set(e.conditionForm,"ruleName",t)},expression:"conditionForm.ruleName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"失败重复次数",prop:"failRetryTimes"}},[i("el-select",{attrs:{placeholder:"请选择失败重复次数"},model:{value:e.conditionForm.failRetryTimes,callback:function(t){e.$set(e.conditionForm,"failRetryTimes",t)},expression:"conditionForm.failRetryTimes"}},e._l([0,1,2,3,4,5],function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"接通重呼条件(秒)",prop:"retryLessBillsec"}},[i("el-input",{attrs:{placeholder:"接通重呼条件(秒)"},model:{value:e.conditionForm.retryLessBillsec,callback:function(t){e.$set(e.conditionForm,"retryLessBillsec",t)},expression:"conditionForm.retryLessBillsec"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"接通重呼次数",prop:"retryTimes"}},[i("el-input",{attrs:{placeholder:"接通重呼次数"},model:{value:e.conditionForm.retryTimes,callback:function(t){e.$set(e.conditionForm,"retryTimes",t)},expression:"conditionForm.retryTimes"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"当日重呼间隔(分钟)",prop:"retryIntervalTime"}},[i("el-input",{attrs:{placeholder:"当日重呼间隔(分钟)"},model:{value:e.conditionForm.retryIntervalTime,callback:function(t){e.$set(e.conditionForm,"retryIntervalTime",t)},expression:"conditionForm.retryIntervalTime"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"工作时间",prop:"workTime"}},[i("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],model:{value:e.conditionForm.workTime,callback:function(t){e.$set(e.conditionForm,"workTime",t)},expression:"conditionForm.workTime"}}),e._v(" "),e._l(e.workTimes,function(t,o){return i("el-row",{key:t.id,staticStyle:{"margin-bottom":"10px"}},[i("el-col",{attrs:{span:10}},[i("el-time-select",{attrs:{placeholder:"起始时间","picker-options":{start:t.start,step:"00:30",end:"24:00"}},model:{value:t.startTime,callback:function(i){e.$set(t,"startTime",i)},expression:"item.startTime"}})],1),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:2}},[e._v("-")]),e._v(" "),i("el-col",{attrs:{span:10}},[i("el-time-select",{attrs:{placeholder:"结束时间","picker-options":{start:t.start,step:"00:30",end:"24:00",minTime:t.startTime}},on:{change:e.transfromTime},model:{value:t.endTime,callback:function(i){e.$set(t,"endTime",i)},expression:"item.endTime"}})],1),e._v(" "),i("el-col",{attrs:{span:1,offset:1}},[0!=o?i("i",{staticClass:"el-icon-delete",on:{click:function(t){e.removeTime(o)}}}):e._e()])],1)})],2),e._v(" "),i("el-button",{staticStyle:{margin:"-20px 0 0 150px"},attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:e.addTime}},[e._v("添加时间")])],1),e._v(" "),i("div",{staticClass:"dialog_submit"},[i("el-button",{attrs:{size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.dialogCloseHandle(t)}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.dialogSubmitHandle(t)}}},[e._v("提 交")])],1)],1)},staticRenderFns:[]};var l=i("vSla")(n,s,!1,function(e){i("1fvw")},"data-v-6922f4a5",null).exports,c=[{key:"id",label:"ID",width:"auto"},{key:"ruleName",label:"规则名称",width:"auto"},{key:"failRetryTimes",label:"失败重呼次数",width:"auto"},{key:"retryLessBillsec",label:"接通重呼条件",width:"auto"},{key:"retryTimes",label:"接通重呼次数",width:"auto"},{key:"retryIntervalTime",label:"当日重呼间隔",width:"auto"},{key:"workTime",label:"工作时间",width:"200"},{key:"createDate",label:"创建时间",width:"150"}],m={data:function(){return{conditionForm:{createTimeMin:"",createTimeMax:"",alarmWord:"",pageSize:15,currentPage:1},searchForm:{},hasSearch:!1,tb:{data:[],fields:c},loading:!1,createTime:[],rules:{},total:0,visible:!1,batchVisible:!1,selected:[]}},components:{pagination:r.a,outCallDialog:l},methods:{addRule:function(){this.visible=!0},deleteRule:function(e){var t=this;this.$confirm("确认删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("/api/assignee/proactiveCallManage/deletePredictiveCallRule",{ruleIds:[e.row.id]}).then(function(e){0==e.data.code?(t.getList(),t.$message.success("删除成功")):t.$util.failCallback(e.data,t)}).catch(function(e){})})},exportWords:function(){var e=this;0==this.selected.length&&this.tb.data.forEach(function(t){e.selected.push(t.alarmWord)}),this.$axios({method:"post",url:"/api/assignee/alarmWord/export",data:{alarmWords:this.selected},responseType:"blob"}).then(function(t){if("application/json"!=t.data.type){var i=decodeURI(t.headers["content-disposition"].split("=")[1]),o=t.data,a=new Blob([o]);if("download"in document.createElement("a")){var r=document.createElement("a");r.download=i,r.style.display="none",r.href=URL.createObjectURL(a),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r)}else navigator.msSaveBlob(a,i)}else e.$message({type:"error",message:"导出失败"})}).catch(function(e){})},importWords:function(){this.batchVisible=!0},createTimeChange:function(e){e?(this.conditionForm.createTimeMin=e[0],this.conditionForm.createTimeMax=e[1]):(this.conditionForm.createTimeMin="",this.conditionForm.createTimeMax="")},reset:function(){this.$refs.conditionForm.resetFields(),this.conditionForm.createTimeMin="",this.conditionForm.createTimeMax="",this.createTime=[],this.searchForm=a()({},this.conditionForm),1==this.conditionForm.currentPage?this.getList(this.conditionForm):(this.conditionForm.currentPage=1,this.hasSearch=!0)},getList:function(e){var t=this;this.loading=!0,this.$axios.post("/api/assignee/proactiveCallManage/queryPredictiveCallRule",{pageSize:this.conditionForm.pageSize,currentPage:this.conditionForm.currentPage}).then(function(e){t.loading=!1,0==e.data.code?(t.tb.data=e.data.data.items,t.total=e.data.data.totalNum):t.$util.failCallback(e.data,t),t.loading=!1}).catch(function(e){t.loading=!1})},changeSize:function(e){this.conditionForm.pageSize=e,this.searchForm.pageSize=e,1==this.conditionForm.currentPage?this.getList(this.conditionForm):(this.conditionForm.currentPage=1,this.getList(this.conditionForm))},changePage:function(e){this.conditionForm.currentPage=e,this.getList()},closeDialog:function(e){this.visible=!1},refresh:function(){1==this.conditionForm.currentPage?this.getList():this.conditionForm.currentPage=1}},created:function(){this.searchForm=a()({},this.conditionForm),this.getList(this.conditionForm)}},d={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"content-body"},[i("div",{staticClass:"bd-top"},[i("div",{staticClass:"md clearfix"},[e._m(0),e._v(" "),i("div",{staticClass:"md-right"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.addRule}},[e._v("新增规则")])],1)])]),e._v(" "),i("div",{staticClass:"bd-main"},[i("div",{staticClass:"table"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",attrs:{"max-height":"500","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading",data:e.tb.data,"tooltip-effect":"dark","empty-text":"暂无数据"}},[e._l(e.tb.fields,function(e){return i("el-table-column",{key:e.id,attrs:{align:"center",prop:e.key,label:e.label,width:e.width}})}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){e.deleteRule(t)}}},[e._v("删除")])]}}])})],2)],1)]),e._v(" "),i("pagination",{attrs:{total:e.total,pageSize:e.conditionForm.pageSize,"current-page":e.conditionForm.currentPage},on:{changePage:e.changePage,changeSize:e.changeSize}}),e._v(" "),i("outCallDialog",{attrs:{visible:e.visible},on:{closeDialog:e.closeDialog,refresh:e.refresh}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"md-left"},[t("h5",[this._v("预测式外呼规则")])])}]};var u=i("vSla")(m,d,!1,function(e){i("OP4f")},"data-v-d69f09bc",null);t.default=u.exports}});