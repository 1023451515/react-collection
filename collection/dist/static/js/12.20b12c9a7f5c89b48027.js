webpackJsonp([12],{P1YM:function(t,e){},fKP0:function(t,e){},tVK5:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("XBA1"),l={name:"telAllotDialog",props:{row:{type:Object},dialogVisible:{type:Boolean}},data:function(){return{save:!1,userId:"",dropDownData:[],departments:[],departmentId:"",departmentProps:{label:"name",value:"id"}}},methods:{close:function(){this.$emit("dialogClose"),this.userId=""},submit:function(){var t=this;if(!this.userId)return this.$alert("未选择催收员?","提示",{confirmButtonText:"确定",type:"warning"}),!1;this.$axios.post("/api/assignee/seatAllot/allot",{id:this.row.id,userId:this.userId}).then(function(e){0==e.data.code?(t.$message({type:"success",message:"保存成功"}),t.save=!0,t.$emit("dialogClose",t.save)):t.$util.failCallback(e.data,t)}).catch(function(t){})},reset:function(){this.close()},getCollectionId:function(){var t=this;this.$axios.post("/api/assignee/seatAllot/getStaffs",{departmentId:this.departmentId}).then(function(e){0==e.data.code?t.dropDownData=e.data.data:t.$util.failCallback(e.data,t)})},getApartment:function(){var t=this;this.$axios.post("/api/assignee/seatAllot/getDepartmentsCondition",{}).then(function(e){0==e.data.code?t.departments=e.data.data:t.$util.failCallback(e.data,t)}).catch(function(t){})},handleChange:function(t){this.userId="",this.departmentId=this.aDepartmentIds[this.aDepartmentIds.length-1],this.getCollectionId()}},created:function(){this.getApartment()}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{title:"号码分配","close-on-click-modal":!1,width:"40%","show-close":!0,visible:t.dialogVisible,center:!0},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close}},[a("el-form",{ref:"conditionForm",staticClass:"dialog-main",attrs:{"label-position":"right","label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:"选择部门",prop:"aDepartmentIds",clearable:""}},[a("el-cascader",{attrs:{options:t.departments,"change-on-select":"",props:t.departmentProps,size:"small"},on:{change:t.handleChange},model:{value:t.aDepartmentIds,callback:function(e){t.aDepartmentIds=e},expression:"aDepartmentIds"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"催收员：",prop:"userId"}},[a("el-select",{attrs:{size:"small",clearable:""},model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}},t._l(this.dropDownData,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item")],1),t._v(" "),a("div",{staticClass:"dialog_submit"},[a("el-button",{attrs:{size:"small"},on:{click:t.reset}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.submit}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var s=a("vSla")(l,n,!1,function(t){a("fKP0")},"data-v-4cae7d04",null).exports,o=a("azh2"),r=[{key:"extensionNumber",label:"分机号",width:"auto"},{key:"extensionPassword",label:"分机密码",width:"auto"},{key:"userName",label:"催收员姓名",width:"auto"},{key:"collectionId",label:"催收员ID",width:"auto"},{key:"allotDate",label:"分配时间",width:"auto"},{key:"allotStatus",label:"分配状态",width:"auto"}],c={data:function(){return{tb:{data:[],fields:r},loading:!1,selected:[],allotStatus:[],conditionForm:{pageSize:15,currentPage:1},total:-1,status:"",dialogVisible:!1,row:{}}},components:{pagination:i.a,telAllotDialog:s,MyTabs:o.a},created:function(){this.getStatus(),this.getList()},methods:{handleSelection:function(t){this.status=t.index,this.getList()},handleSelectionChange:function(){},rowClick:function(t){this.row=t,this.$refs.multipleTable.clearSelection(),this.$refs.multipleTable.toggleRowSelection(t)},chooseVisiter:function(t,e){this.row=e,this.$refs.multipleTable.clearSelection(),this.$refs.multipleTable.toggleRowSelection(e)},changePage:function(t){this.conditionForm.currentPage=t,this.getList()},getStatus:function(){var t=this;this.$axios.post("/api/assignee/seatAllot/getAllotStatus",{}).then(function(e){0==e.data.code?(t.allotStatus=e.data.data,t.allotStatus.map(function(t){t.name=t.name+"（"+t.count+"）",t.index=t.code,null===t.index&&(t.index=-1)}),t.status=-1):t.$util.failCallback(e.data,t)}).catch(function(t){})},getList:function(){var t=this,e={};null===this.status||-1==this.status||(e.allotStatus=this.status),this.$axios.post("/api/assignee/seatAllot/getAllotList",e).then(function(e){0==e.data.code?(t.tb.data=e.data.data.items,t.total=e.data.data.totalNum):t.$util.failCallback(e.data,t)}).catch(function(t){})},openEditDialog:function(t){this.row=t.row,this.dialogVisible=!0},dialogClose:function(t){t&&this.getList(),this.dialogVisible=!1},allotTelephone:function(){return this.row.extensionNumber?"已分配"===this.row.allotStatus?(this.$alert("号码已分配！","提示",{confirmButtonText:"确定",type:"warning"}),!1):void(this.dialogVisible=!0):(this.$alert("请选择分机号进行操作！","提示",{confirmButtonText:"确定",type:"warning"}),!1)}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-body"},[a("div",{staticClass:"bd-top"},[a("div",{staticClass:"md clearfix"},[t._m(0),t._v(" "),a("div",{staticClass:"md-right"},[a("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.allotTelephone(e)}}},[t._v("分配号码")])],1)])]),t._v(" "),a("div",{staticClass:"bd-main"},[a("div",{staticClass:"tabsPublic"},[a("MyTabs",{attrs:{tabIndex:t.status,tabList:t.allotStatus},on:{changeTab:t.handleSelection}})],1),t._v(" "),a("div",{staticClass:"table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"out_visit_table",attrs:{height:"700","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading",data:t.tb.data,"tooltip-effect":"dark","empty-text":"暂无数据"},on:{"selection-change":t.handleSelectionChange,"row-click":t.rowClick,select:t.chooseVisiter}},[a("el-table-column",{attrs:{type:"selection",width:"55",fixed:"left"}}),t._v(" "),t._l(t.tb.fields,function(t){return a("el-table-column",{key:t.id,attrs:{align:t.align||"left",prop:t.key,label:t.label,width:t.width}})}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",disabled:"已分配"!=e.row.allotStatus},nativeOn:{click:function(a){a.preventDefault(),t.openEditDialog(e)}}},[t._v("重新分配")])]}}])})],2)],1)]),t._v(" "),a("el-pagination",{attrs:{small:"","current-page":t.conditionForm.currentPage,"page-size":t.conditionForm.pageSize,layout:"total, prev, pager, next,jumper",total:t.total},on:{"current-change":t.changePage,"update:currentPage":function(e){t.$set(t.conditionForm,"currentPage",e)}}}),t._v(" "),t.dialogVisible?a("telAllotDialog",{attrs:{dialogVisible:t.dialogVisible,row:t.row},on:{dialogClose:t.dialogClose}}):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"md-left"},[e("h5",[this._v("坐席分配")])])}]};var u=a("vSla")(c,d,!1,function(t){a("P1YM")},"data-v-58df8257",null);e.default=u.exports}});