webpackJsonp([19],{J42G:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o("HzJ8"),a=o.n(i),n=o("aA9S"),l=o.n(n),r=o("yt7g"),s=[{label:"工单编号",key:"code",width:"auto",type:"0"},{label:"问题内容",key:"content",width:"280",type:"0"},{label:"提交时间",key:"createTime",width:"auto",type:"0"},{label:"工单类型",key:"questionTypeName",width:"auto",type:"0"},{label:"状态",key:"statusName",width:"auto",type:"0"}],c={components:{pagination:o("XBA1").a},data:function(){return{hasSolve:!0,dropdownData:{},conditionForm:{code:"",content:"",commitDate:[],commitDateMax:"",commitDateMin:"",status:"",questionType:"",currentPage:1,pageSize:15},operationBtns:[{name:"工单详情",identifier:"sponsor_position_create",dialog:{dialogFormVisible:!1,form:{},rule:{},formName:"createForm",url:"/api/consigner/approve/checkBill",title:"工单详情"},isShow:!1}],commentForm:{content:"",feedbackLevel:5,files:[],id:""},formData:{},searchForm:{},hasSearch:!1,tb:{data:[],fields:s},currentPage:1,total:0,loading:!0,tempRow:{}}},computed:{},created:function(){this.searchForm=l()({},this.conditionForm),this.getList(this.conditionForm),this.getdropdownData()},methods:{dialogCloseTrigger:function(t){t.dialog.form={},this.commentForm={content:"",feedbackLevel:5,files:[],id:""},this.hasSolve=!0},closeWork:function(t){var e=this;this.$axios.post("/api/assignee/workOrder/closeWorkOrder",{id:t.dialog.form.id}).then(function(o){0==o.data.code?(t.dialog.dialogFormVisible=!1,t.dialog.form={},e.getList(e.conditionForm)):r.failCallback(o.data,e)}).catch(function(t){})},uploadImg:function(){var t=document.getElementById("logo_img").files;if(t&&t.length){var e=!0,o=!1,i=void 0;try{for(var n,l=a()(t);!(e=(n=l.next()).done);e=!0){var r=n.value;if(r.size/1024/1024>8)return this.$message.error("文件不能大于2M"),!1;this.commentForm.files.push(r)}}catch(t){o=!0,i=t}finally{try{!e&&l.return&&l.return()}finally{if(o)throw i}}}},deleteFile:function(t){this.commentForm.files.splice(t,1)},dialogSubmitHandle:function(t){var e=this;this.$refs.commentForm.validate(function(o){if(o){if(e.commentForm.files.length>5)return e.$message.warning("文件数量最多为5"),!1;if(e.formData=new FormData,e.formData.append("id",t.dialog.form.id),e.hasSolve)e.formData.append("feedbackLevel",e.commentForm.feedbackLevel);else{var i=!0,n=!1,l=void 0;try{for(var r,s=a()(e.commentForm.files);!(i=(r=s.next()).done);i=!0){var c=r.value;e.formData.append("files",c)}}catch(t){n=!0,l=t}finally{try{!i&&s.return&&s.return()}finally{if(n)throw l}}e.formData.append("content",e.commentForm.content)}e.$axios.post("/api/assignee/workOrder/commentWorkOrder",e.formData).then(function(o){0==o.data.code?(e.$message({type:"success",message:"保存成功"}),e.dialogCloseHandle(t)):e.$util.failCallback(o.data,e)}).catch(function(t){})}})},dialogCloseHandle:function(t){t.dialog.dialogFormVisible=!1},openDetailDialog:function(t,e){var o=this;this.$axios.post("/api/assignee/workOrder/getWorkOrderDetail",{id:e.id}).then(function(e){0==e.data.code?(t.dialog.form=e.data.data,t.dialog.dialogFormVisible=!0):r.failCallback(e.data,o)}).catch(function(t){})},getdropdownData:function(){var t=this;this.$axios.post("/api/assignee/workOrder/getInitValues",{}).then(function(e){0==e.data.code?t.dropdownData=e.data.data:r.failCallback(e.data,t)}).catch(function(t){})},getList:function(t){var e,o=this;e=t||this.conditionForm,this.loading=!0,this.$axios.post("/api/assignee/workOrder/getWorkOrderList",e).then(function(t){0==t.data.code?(o.tb.data=t.data.data.items,o.total=t.data.data.totalNum):r.failCallback(t.data,o),o.loading=!1}).catch(function(t){o.loading=!1})},changeSize:function(t){this.conditionForm.pageSize=t,this.searchForm.pageSize=t,1==this.conditionForm.currentPage?this.getList(this.conditionForm):(this.conditionForm.currentPage=1,this.getList(this.conditionForm))},commitDateChange:function(t){if(null==t)return this.conditionForm.commitDateMin="",void(this.conditionForm.commitDateMax="");this.conditionForm.commitDateMin=t[0],this.conditionForm.commitDateMax=t[1]},search:function(){var t=this;this.$refs.conditionForm.validate(function(e){e&&(t.searchForm=l()({},t.conditionForm),1==t.conditionForm.currentPage?t.getList(t.conditionForm):(t.conditionForm.currentPage=1,t.getList(t.conditionForm),t.hasSearch=!0))})},reset:function(){this.$refs.conditionForm.resetFields(),this.conditionForm.commitDateMin="",this.conditionForm.commitDateMax="",this.searchForm=l()({},this.conditionForm),1==this.conditionForm.currentPage?this.getList(this.conditionForm):(this.conditionForm.currentPage=1,this.getList(this.conditionForm),this.hasSearch=!0)},handleCurrentPage:function(t){this.searchForm.currentPage=t,this.hasSearch?(this.getList(this.conditionForm),this.hasSearch=!1):(this.conditionForm=l()({},this.searchForm),this.getList(this.searchForm))},download:function(t){var e=this;this.$axios({method:"post",url:"/api/assignee/workOrder/downLoad",data:{name:t.name,url:t.url,id:t.id},responseType:"blob"}).then(function(t){if("application/json"!=t.data.type){var o=t.data,i=new Blob([o]),a=decodeURI(t.headers["content-disposition"].split("=")[1]);if("download"in document.createElement("a")){var n=document.createElement("a");n.download=a,n.style.display="none",n.href=URL.createObjectURL(i),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}else navigator.msSaveBlob(i,a)}else e.$message({type:"error",message:"下载失败"})}).catch(function(t){})}}},d={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"content-body"},[t._m(0),t._v(" "),o("div",{staticClass:"bd-main"},[o("el-form",{ref:"conditionForm",staticClass:"condition-form",attrs:{model:t.conditionForm,"label-width":this.$util.LABEL_WIDTH,size:"mini","label-position":"right"}},[o("div",{staticClass:"el-col fixed-width"},[o("el-form-item",{attrs:{label:"工单编号",prop:"code"}},[o("el-input",{model:{value:t.conditionForm.code,callback:function(e){t.$set(t.conditionForm,"code",e)},expression:"conditionForm.code"}})],1)],1),t._v(" "),o("div",{staticClass:"el-col fixed-width"},[o("el-form-item",{attrs:{label:"时间",prop:"commitDate"}},[o("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.commitDateChange},model:{value:t.conditionForm.commitDate,callback:function(e){t.$set(t.conditionForm,"commitDate",e)},expression:"conditionForm.commitDate"}})],1)],1),t._v(" "),o("div",{staticClass:"el-col fixed-width"},[o("el-form-item",{attrs:{label:"关键字",prop:"content"}},[o("el-input",{model:{value:t.conditionForm.content,callback:function(e){t.$set(t.conditionForm,"content",e)},expression:"conditionForm.content"}})],1)],1),t._v(" "),o("div",{staticClass:"el-col fixed-width"},[o("el-form-item",{attrs:{label:"状态",prop:"status"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.conditionForm.status,callback:function(e){t.$set(t.conditionForm,"status",e)},expression:"conditionForm.status"}},[o("el-option",{attrs:{label:"All",value:""}}),t._v(" "),t._l(t.dropdownData.statusList,function(t){return o("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})})],2)],1)],1),t._v(" "),o("div",{staticClass:"el-col fixed-width"},[o("el-form-item",{attrs:{label:"工单类型",prop:"questionType"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.conditionForm.questionType,callback:function(e){t.$set(t.conditionForm,"questionType",e)},expression:"conditionForm.questionType"}},[o("el-option",{attrs:{label:"All",value:""}}),t._v(" "),t._l(t.dropdownData.questionList,function(t){return o("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})})],2)],1)],1),t._v(" "),o("div",{staticClass:"el-col fixed-width form-btns"},[o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.search}},[t._v("搜索")]),t._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:t.reset}},[t._v("重置")])],1)]),t._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",attrs:{data:t.tb.data,"tooltip-effect":"dark","max-height":"460","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","show-overflow-tooltip":""}},[t._l(t.tb.fields,function(e){return o("el-table-column",{key:e.id,attrs:{align:e.align||"left",prop:e.key,label:e.label,width:e.width},scopedSlots:t._u([{key:"default",fn:function(i){return["0"==e.type?[t._v("\n              "+t._s(i.row[i.column.property])+"\n            ")]:t._e(),t._v(" "),"1"==e.type?[o("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){t.preventDefault()}}},[t._v("\n                "+t._s(i.row[i.column.property])+"\n              ")])]:t._e(),t._v(" "),"2"==e.type?[o("a",{staticClass:"el-button--text el-button--small",staticStyle:{"text-decoration":"underline"},attrs:{href:"javascript:void(0)"},on:{click:function(o){t.downLoad(i,e.caseListType)}}},[t._v(t._s("0"==i.row.isFile?"":"附件可下载"))])]:t._e()]}}])})}),t._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){t.openDetailDialog(t.operationBtns[0],e.row)}}},[t._v("查看详情")])]}}])})],2),t._v(" "),o("pagination",{attrs:{total:t.total,pageSize:t.conditionForm.pageSize,currentPage:t.conditionForm.currentPage},on:{changePage:t.handleCurrentPage,changeSize:t.changeSize}}),t._v(" "),o("el-dialog",{attrs:{title:t.operationBtns[0].dialog.title,visible:t.operationBtns[0].dialog.dialogFormVisible,"close-on-click-modal":!1,size:"small"},on:{"update:visible":function(e){t.$set(t.operationBtns[0].dialog,"dialogFormVisible",e)},close:function(e){t.dialogCloseTrigger(t.operationBtns[0])}}},[o("el-form",{staticClass:"dialog-main",attrs:{size:"mini",model:t.operationBtns[0].dialog.form,"label-width":"100px",rules:t.operationBtns[0].dialog.rule}},[o("el-form-item",{attrs:{label:"工单类型",prop:"questionTypeName"}},[o("el-input",{attrs:{"auto-complete":"off",disabled:"",size:"small"},model:{value:t.operationBtns[0].dialog.form.questionTypeName,callback:function(e){t.$set(t.operationBtns[0].dialog.form,"questionTypeName",e)},expression:"operationBtns[0].dialog.form.questionTypeName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"优先级",prop:"priority"}},[o("el-radio-group",{model:{value:t.operationBtns[0].dialog.form.priority,callback:function(e){t.$set(t.operationBtns[0].dialog.form,"priority",e)},expression:"operationBtns[0].dialog.form.priority"}},t._l(t.dropdownData.priorityList,function(e){return o("el-radio",{key:e.id,attrs:{label:e.code,disabled:""}},[t._v(t._s(e.name))])}))],1),t._v(" "),o("el-form-item",{attrs:{label:"问题描述",prop:"content"}},[o("el-input",{attrs:{type:"textarea","auto-complete":"off",disabled:"",size:"small"},model:{value:t.operationBtns[0].dialog.form.content,callback:function(e){t.$set(t.operationBtns[0].dialog.form,"content",e)},expression:"operationBtns[0].dialog.form.content"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[o("el-input",{attrs:{"auto-complete":"off",disabled:"",size:"small"},model:{value:t.operationBtns[0].dialog.form.email,callback:function(e){t.$set(t.operationBtns[0].dialog.form,"email",e)},expression:"operationBtns[0].dialog.form.email"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"附件"}},t._l(t.operationBtns[0].dialog.form.filesBean,function(e){return o("el-button",{key:e.id,attrs:{type:"text"},on:{click:function(o){t.download(e)}}},[t._v(t._s(e.name))])})),t._v(" "),2==t.operationBtns[0].dialog.form.status||3==t.operationBtns[0].dialog.form.status?[o("el-form-item",{attrs:{label:"反馈时间",prop:"updateTime"}},[o("el-input",{attrs:{"auto-complete":"off",disabled:""},model:{value:t.operationBtns[0].dialog.form.updateTime,callback:function(e){t.$set(t.operationBtns[0].dialog.form,"updateTime",e)},expression:"operationBtns[0].dialog.form.updateTime"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"反馈结果",prop:"feedback"}},[o("el-input",{attrs:{type:"textarea","auto-complete":"off",disabled:""},model:{value:t.operationBtns[0].dialog.form.feedback,callback:function(e){t.$set(t.operationBtns[0].dialog.form,"feedback",e)},expression:"operationBtns[0].dialog.form.feedback"}})],1)]:t._e(),t._v(" "),t._l(t.operationBtns[0].dialog.form.followIssue,function(e,i){return t.operationBtns[0].dialog.form.followIssue.length>0?[o("el-form-item",{attrs:{label:"问题描述",prop:"followContent"}},[o("el-input",{attrs:{type:"textarea","auto-complete":"off",disabled:""},model:{value:e.followContent,callback:function(o){t.$set(e,"followContent",o)},expression:"followIssueItem.followContent"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"附件"}},t._l(e.issueFiles,function(e){return o("el-button",{key:e.id,attrs:{type:"text"},on:{click:function(o){t.download(e)}}},[t._v(t._s(e.name))])})),t._v(" "),o("el-form-item",{attrs:{label:"反馈结果",prop:"feedback"}},[o("el-input",{attrs:{type:"textarea","auto-complete":"off",disabled:""},model:{value:e.feedback,callback:function(o){t.$set(e,"feedback",o)},expression:"followIssueItem.feedback"}})],1)]:t._e()}),t._v(" "),o("el-form-item",{attrs:{label:"工单状态",prop:"statusName"}},[o("el-input",{attrs:{"auto-complete":"off",disabled:"",size:"small"},model:{value:t.operationBtns[0].dialog.form.statusName,callback:function(e){t.$set(t.operationBtns[0].dialog.form,"statusName",e)},expression:"operationBtns[0].dialog.form.statusName"}})],1),t._v(" "),o("el-form",{ref:"commentForm",staticClass:"commentForm",attrs:{size:"mini","label-width":"100px",model:t.commentForm}},[2==t.operationBtns[0].dialog.form.status?[o("el-form-item",{attrs:{label:"是否解决了您的问题"}},[o("el-radio-group",{model:{value:t.hasSolve,callback:function(e){t.hasSolve=e},expression:"hasSolve"}},[o("el-radio-button",{attrs:{label:!0}},[t._v("是")]),t._v(" "),o("el-radio-button",{attrs:{label:!1}},[t._v("否")])],1)],1),t._v(" "),1==t.hasSolve?[o("el-form-item",{attrs:{label:"评价",prop:"feedbackLevel"}},[o("el-rate",{attrs:{"show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:t.commentForm.feedbackLevel,callback:function(e){t.$set(t.commentForm,"feedbackLevel",e)},expression:"commentForm.feedbackLevel"}})],1)]:[o("el-form-item",{attrs:{label:"问题描述",prop:"content",rules:[{required:!0,message:"必填项",trigger:"change,blur"}]}},[o("el-input",{attrs:{type:"textarea","auto-complete":"off",size:"small"},model:{value:t.commentForm.content,callback:function(e){t.$set(t.commentForm,"content",e)},expression:"commentForm.content"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"附件",prop:"files",rules:[{required:!0,message:"必填项",trigger:"change,blur"}]}},[o("a",{staticClass:"a-upload",attrs:{href:"javascript:;"}},[o("input",{attrs:{type:"file",name:"files",id:"logo_img",title:"",multiple:""},on:{change:t.uploadImg}}),t._v("上传附件\n                  ")]),t._v(" "),o("ul",{attrs:{id:"fileName"}},t._l(t.commentForm.files,function(e,i){return o("li",{key:e.id,staticClass:"fileName el-upload-list__item is-finished",attrs:{index:i}},[t._v(t._s(e.name)+"\n                      "),o("i",{staticClass:"el-icon-close",on:{click:function(e){t.deleteFile(i)}}})])})),t._v(" "),o("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],model:{value:t.commentForm.files[0],callback:function(e){t.$set(t.commentForm.files,0,e)},expression:"commentForm.files[0]"}})],1)]]:t._e()],2)],2),t._v(" "),o("div",{staticClass:"dialog_submit"},[1==t.operationBtns[0].dialog.form.status?o("el-button",{attrs:{size:"small"},nativeOn:{click:function(e){e.preventDefault(),t.closeWork(t.operationBtns[0])}}},[t._v("关闭工单")]):2==t.operationBtns[0].dialog.form.status?o("el-button",{attrs:{size:"small"},nativeOn:{click:function(e){e.preventDefault(),t.dialogSubmitHandle(t.operationBtns[0])}}},[t._v("提交")]):t._e()],1)],1)],1)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"bd-top"},[e("div",{staticClass:"md clearfix"},[e("div",{staticClass:"md-left"},[e("h5",[this._v("我的工单")])]),this._v(" "),e("div",{staticClass:"md-right"})])])}]};var m=o("vSla")(c,d,!1,function(t){o("nb5H")},"data-v-e745ff88",null);e.default=m.exports},nb5H:function(t,e){}});