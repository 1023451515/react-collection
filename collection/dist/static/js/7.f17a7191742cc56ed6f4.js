webpackJsonp([7],{DjZG:function(t,e){},MozV:function(t,e){},ZhfV:function(t,e){},qEaK:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("aA9S"),o=i.n(a),s=(i("5YEj"),i("6iV/"),[{key:"allotTime",label:"分配时间",width:"auto",align:"center",id:"0"},{key:"recoverTime",label:"回收时间",width:"auto",align:"center",id:"2"},{key:"recoverReason",label:"回收原因",width:"auto",align:"center",id:"3"}]),n={name:"visitDetail",data:function(){return{aDepartmentIds:[],aStuffId:"",departmentProps:{label:"name",value:"id"},workers:[],departmentId:"",hasAbility:!1,loading:!1,tb:{data:[],fields:s}}},props:{detailShow:{type:Boolean},taskId:{}},methods:{close:function(){this.$emit("closeDetail")},getList:function(){var t=this;this.loading=!0,this.$axios.post("/api/assignee/visitManage/getTaskLog",{taskId:this.taskId}).then(function(e){0==e.data.code?t.tb.data=e.data.data:t.$util.failCallback(e.data,t),t.loading=!1}).catch(function(e){t.loading=!1})}},created:function(){this.getList()}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form"},[i("el-dialog",{attrs:{"close-on-click-modal":!1,"show-close":!0,title:"历史分配记录",visible:t.detailShow,center:!0,id:"dialog"},on:{"update:visible":function(e){t.detailShow=e},close:t.close}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",attrs:{data:t.tb.data,"tooltip-effect":"dark","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[i("el-table-column",{attrs:{type:"index",fixed:"left"}}),t._v(" "),t._l(t.tb.fields,function(t){return i("el-table-column",{key:t.key,attrs:{align:t.align||"left",prop:t.key,label:t.label,width:t.width,"show-overflow-tooltip":""}})})],2)],1)],1)},staticRenderFns:[]};var r=i("vSla")(n,l,!1,function(t){i("MozV")},"data-v-1d713116",null).exports,c={name:"allotVisit",data:function(){return{aDepartmentIds:[],aStuffId:"",departmentProps:{label:"name",value:"id"},workers:[],departmentId:"",hasAbility:!1}},props:{allotShow:{type:Boolean},departments:{type:Array},selected:{type:Array}},methods:{close:function(){this.cancelForm()},handleChange:function(t){this.aStuffId="",this.departmentId=this.aDepartmentIds[this.aDepartmentIds.length-1],this.getWorkers()},submitForm:function(){if(this.departmentId){if(!this.hasAbility&&!this.aStuffId)return this.$alert("未选择催收员！","提示",{confirmButtonText:"确定",type:"warning"}),!1;this.allotChooseCase()}else this.$alert("未选择部门！","提示",{confirmButtonText:"确定",type:"warning"})},cancelForm:function(){this.aDepartmentIds=[],this.aStuffId="",this.$emit("allotClose")},getWorkers:function(){var t=this;this.$axios.post("/api/assignee/caseManage/getStaffs",{departmentId:this.departmentId}).then(function(e){0==e.data.code?t.workers=e.data.data:t.$util.failCallback(e.data,t)}).catch(function(t){})},allotChooseCase:function(){var t=this;this.$axios.post("/api/assignee/visitManage/allotTask",{taskDepartmentId:this.departmentId,taskId:this.selected,taskStaffId:this.aStuffId}).then(function(e){0==e.data.code?(t.$message.success("外访任务分配成功"),t.cancelForm(),t.$emit("refreshList")):t.$util.failCallback(e.data,t)}).catch(function(t){})}},created:function(){}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form"},[i("el-dialog",{attrs:{"close-on-click-modal":!1,"show-close":!0,title:"外访任务分配",visible:t.allotShow,center:!0,id:"dialog"},on:{"update:visible":function(e){t.allotShow=e},close:t.close}},[i("el-form",{staticClass:"dialog-main",attrs:{"label-width":"100px",size:"small"}},[i("el-form-item",{attrs:{label:"选择部门",prop:"aDepartmentIds",clearable:""}},[i("el-cascader",{attrs:{options:t.departments,"change-on-select":"",props:t.departmentProps,size:"small"},on:{change:t.handleChange},model:{value:t.aDepartmentIds,callback:function(e){t.aDepartmentIds=e},expression:"aDepartmentIds"}})],1),t._v(" "),t.hasAbility?t._e():i("el-form-item",{attrs:{label:"选择催收员",prop:"aStuffId",clearable:""}},[i("el-select",{attrs:{size:"small"},model:{value:t.aStuffId,callback:function(e){t.aStuffId=e},expression:"aStuffId"}},t._l(t.workers,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),i("div",{staticClass:"dialog_submit"},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return e.preventDefault(),t.submitForm(e)}}},[t._v("提交")]),t._v(" "),i("el-button",{attrs:{size:"small"},on:{click:t.cancelForm}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]};var h=[{key:"visitCode",label:"外访编号",width:"100",id:"0",type:"0"},{key:"visitName",label:"被访人",width:"",id:"2",type:"0"},{key:"relation",label:"关系",width:"auto",id:"3",type:"0"},{key:"visitAddress",label:"外访地区",width:"100",id:"4",type:"0"},{key:"addressType",label:"地址类型",width:"",id:"5",type:"0"},{key:"taskStaffName",label:"外访员",width:"100",id:"6",type:"0"},{key:"staffId",label:"催收员（催收员ID）",width:"150",id:"7",type:"0"},{key:"departmentName",label:"部门",width:"100",id:"9",type:"0"},{key:"applyTime",label:"外访申请时间",width:"100",id:"10",type:"0"},{key:"visitTime",label:"计划外访时间",width:"100",type:"0"},{key:"caseCode",label:"案件编号",width:"100",id:"15",type:"0"},{key:"loanInstitution",label:"贷款机构",width:"100",id:"11",type:"0"},{key:"productName",label:"贷款产品",width:"100",id:"12",type:"0"},{key:"latestDebtMoney",label:"最新欠款金额",width:"100",id:"13",align:"right",type:"0"},{key:"commitMoney",label:"委案金额",width:"100",id:"14",align:"right",type:"0"},{key:"borrowerName",label:"客户姓名",width:"100",id:"16",type:"0"},{key:"overdueDay",label:"逾期天数",width:"100",id:"18",type:"0"},{key:"receivableAge",label:"账龄",width:"",id:"19",type:"0"},{key:"batchTimes",label:"手别",width:"",id:"20",type:"0"},{key:"statusName",label:"分配状态",width:"auto",id:"21",type:"0"}],p={components:{visitDetail:r,allotVisit:i("vSla")(c,d,!1,function(t){i("DjZG")},"data-v-244995be",null).exports,myTable:i("4OB+").a},data:function(){return{conditionForm:{province:"",city:"",district:"",addressType:"",status:"",relation:"",departmentId:"",staffId:"",applyTimeMin:"",applyTimeMax:"",visitCode:"",caseCode:"",currentPage:1,pageSize:15,visitStatus:""},searchForm:{},hasSearch:!1,flag:!0,dropdownData:{},departments:[],department:[],staffs:[],loanInstitution:[],tb:{data:[],fields:h,selectionBtn:!0,height:460},chooseAllotData:[],chooseInvokData:[],selected:[],total:0,departmentIds:[],departmentId:"",departmentProps:{label:"name",value:"id"},loading:!1,id:"",cityDisabled:!0,distinctDisabled:!0,applyTime:[],taskId:"",detailShow:!1,allotVisitShow:!1,city:[],district:[],chooseWrong:!1,chooseProvince:{},chooseCity:{},chooseDistinct:{}}},methods:{search:function(){var t=this;this.$refs.conditionForm.validate(function(e){e&&(t.searchForm=o()({},t.conditionForm),1==t.conditionForm.currentPage?t.getList(t.conditionForm):(t.conditionForm.currentPage=1,t.getList(t.conditionForm),t.hasSearch=!0))})},reset:function(){this.$refs.conditionForm.resetFields(),this.departmentIds=[],this.staffs=[],this.conditionForm.applyTimeMin="",this.conditionForm.applyTimeMax="",this.applyTime=[],this.conditionForm.city="",this.conditionForm.district="",this.conditionForm.province="",this.chooseProvince="",this.chooseCity="",this.chooseDistinct="",this.searchForm=o()({},this.conditionForm),1==this.conditionForm.currentPage?this.getList(this.conditionForm):(this.conditionForm.currentPage=1,this.getList(this.conditionForm),this.hasSearch=!0)},handleSelectionChange:function(t){var e=this;this.selected=[],this.chooseWrong=!1;var i=t.every(function(t,i){return e.selected.push(t.taskId),0==t.status});this.chooseWrong=!i},handleCurrentChange:function(t){this.searchForm.currentPage=t,this.hasSearch?(this.getList(this.conditionForm),this.hasSearch=!1):(this.conditionForm=o()({},this.searchForm),this.getList(this.searchForm))},getList:function(t){var e,i=this;e=t||this.conditionForm,this.loading=!0,this.$axios.post("/api/assignee/visitManage/queryVisitTask",e).then(function(t){0==t.data.code?(i.tb.data=t.data.data.items,i.tb.data.forEach(function(t){t.staffId=null==t.staffName?"空":t.staffName+"（"+t.staffId+"）"}),i.total=t.data.data.totalNum):i.$util.failCallback(t.data,i),i.loading=!1}).catch(function(t){i.loading=!1})},changeSize:function(t){this.conditionForm.pageSize=t,this.searchForm.pageSize=t,1==this.conditionForm.currentPage?this.getList(this.conditionForm):(this.conditionForm.currentPage=1,this.getList(this.conditionForm))},getOptions:function(){var t=this;this.$axios.post("/api/assignee/visitManage/initParam",{}).then(function(e){0==e.data.code?(t.dropdownData=e.data.data,t.dropdownData.city=[]):t.$util.failCallback(e.data,t)}).catch(function(t){})},getApartment:function(){var t=this;this.$axios.post("/api/assignee/caseManage/getDepartmentsConditionByBatch",{}).then(function(e){0==e.data.code?t.departments=e.data.data:t.$util.failCallback(e.data,t)}).catch(function(t){})},getDepartmentId:function(t){var e=this;0==t.length?(this.staffs=[],this.conditionForm.staffId="",this.conditionForm.departmentId=""):(this.conditionForm.departmentId=this.departmentIds[this.departmentIds.length-1],this.$axios.post("/api/assignee/caseManage/getStaffsByBatch",{departmentId:this.conditionForm.departmentId}).then(function(t){0==t.data.code?e.staffs=t.data.data:e.$util.failCallback(t.data,e)}).catch(function(t){}))},applyTimeChange:function(t){t?(this.conditionForm.applyTimeMin=t[0],this.conditionForm.applyTimeMax=t[1]):(this.conditionForm.applyTimeMin="",this.conditionForm.applyTimeMax="")},refreshList:function(){this.getList()},showDetail:function(t){this.taskId=t.row.taskId,this.detailShow=!0},closeDetail:function(){this.detailShow=!1},allotApply:function(){this.chooseWrong?this.$alert("含有已分配外访任务，请重新选择！","提示",{confirmButtonText:"确定",type:"warning"}):0!=this.selected.length?this.allotVisitShow=!0:this.$alert("请选择未分配外访任务！","提示",{confirmButtonText:"确定",type:"warning"})},allotClose:function(){this.allotVisitShow=!1},provinceChange:function(t){if(this.city=[],this.district=[],this.chooseCity={},this.chooseDistinct={},!t)return this.conditionForm.province="",this.conditionForm.city="",void(this.conditionForm.district="");this.conditionForm.province=t.name,this.getArea(t.code,1)},cityChange:function(t){if(this.district=[],this.chooseDistinct={},!t)return this.conditionForm.district="",void(this.conditionForm.city="");this.conditionForm.city=t.name,this.getArea(t.code,2)},distinctChange:function(t){this.conditionForm.district=t?t.name:""},getArea:function(t,e){var i=this;this.$axios.post("/api/assignee/visitManage/queryAreaByParent",{addressType:e,addressCode:t}).then(function(t){0==t.data.code?1==e?(i.city=t.data.data,i.conditionForm.district="",i.chooseDistinct={}):2==e&&(i.district=t.data.data,i.chooseDistinct={}):i.$util.failCallback(t.data,i)}).catch(function(t){})}},created:function(){this.getOptions(),this.getApartment(),this.searchForm=o()({},this.conditionForm),this.getList()}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"content-body"},[i("div",{staticClass:"bd-top"},[i("div",{staticClass:"md clearfix"},[t._m(0),t._v(" "),i("div",{staticClass:"md-right"},[i("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.allotApply(e)}}},[t._v("外访任务分配")])],1)])]),t._v(" "),i("div",{staticClass:"bd-main"},[i("el-form",{ref:"conditionForm",staticClass:"condition-form",attrs:{model:t.conditionForm,"label-width":this.$util.LABEL_WIDTH,"label-position":"right",size:"mini"}},[i("div",{staticClass:"el-col fixed-width",staticStyle:{width:"40%"}},[i("el-form-item",{attrs:{label:"外访地区",prop:"province"}},[i("el-select",{staticClass:"selects",attrs:{placeholder:"省",clearable:"","value-key":"code"},on:{change:t.provinceChange},model:{value:t.chooseProvince,callback:function(e){t.chooseProvince=e},expression:"chooseProvince"}},[i("el-option",{attrs:{label:"All",value:""}}),t._v(" "),t._l(t.dropdownData.province,function(t){return i("el-option",{key:t.code,attrs:{label:t.name,value:t}})})],2),t._v(" "),i("el-select",{staticClass:"selects",attrs:{placeholder:"市",clearable:"","value-key":"code"},on:{change:t.cityChange},model:{value:t.chooseCity,callback:function(e){t.chooseCity=e},expression:"chooseCity"}},[i("el-option",{attrs:{label:"All",value:""}}),t._v(" "),t._l(t.city,function(t){return i("el-option",{key:t.code,attrs:{label:t.name,value:t}})})],2),t._v(" "),i("el-select",{staticClass:"selects",attrs:{placeholder:"区/县",clearable:"","value-key":"code"},on:{change:t.distinctChange},model:{value:t.chooseDistinct,callback:function(e){t.chooseDistinct=e},expression:"chooseDistinct"}},[i("el-option",{attrs:{label:"All",value:""}}),t._v(" "),t._l(t.district,function(t){return i("el-option",{key:t.code,attrs:{label:t.name,value:t}})})],2)],1)],1),t._v(" "),i("div",{staticClass:"el-col fixed-width"},[i("el-form-item",{attrs:{label:"地址类型",prop:"addressType"}},[i("el-select",{attrs:{placeholder:"请选择地址类型",clearable:""},model:{value:t.conditionForm.addressType,callback:function(e){t.$set(t.conditionForm,"addressType",e)},expression:"conditionForm.addressType"}},[i("el-option",{attrs:{label:"All",value:""}}),t._v(" "),t._l(t.dropdownData.addressType,function(t){return i("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})})],2)],1)],1),t._v(" "),i("div",{staticClass:"el-col fixed-width"},[i("el-form-item",{attrs:{label:"分配状态",prop:"status"}},[i("el-select",{attrs:{placeholder:"请选择分配状态",clearable:""},model:{value:t.conditionForm.status,callback:function(e){t.$set(t.conditionForm,"status",e)},expression:"conditionForm.status"}},[i("el-option",{attrs:{label:"All",value:""}}),t._v(" "),t._l(t.dropdownData.status,function(t){return i("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})})],2)],1)],1),t._v(" "),i("div",{staticClass:"el-col fixed-width"},[i("el-form-item",{attrs:{label:"外访状态",prop:"status"}},[i("el-select",{attrs:{placeholder:"请选择外访状态",clearable:""},model:{value:t.conditionForm.visitStatus,callback:function(e){t.$set(t.conditionForm,"visitStatus",e)},expression:"conditionForm.visitStatus"}},[i("el-option",{attrs:{label:"All",value:""}}),t._v(" "),t._l(t.dropdownData.visitStatus,function(t){return i("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})})],2)],1)],1),t._v(" "),i("div",{staticClass:"el-col fixed-width"},[i("el-form-item",{attrs:{label:"关系",prop:"relation"}},[i("el-select",{attrs:{placeholder:"请选择关系",clearable:""},model:{value:t.conditionForm.relation,callback:function(e){t.$set(t.conditionForm,"relation",e)},expression:"conditionForm.relation"}},[i("el-option",{attrs:{label:"All",value:""}}),t._v(" "),t._l(t.dropdownData.relation,function(t){return i("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})})],2)],1)],1),t._v(" "),i("div",{staticClass:"el-col fixed-width"},[i("el-form-item",{attrs:{label:"催收部门",prop:"departmentId"}},[i("el-cascader",{attrs:{options:t.departments,"change-on-select":"",props:t.departmentProps,clearable:""},on:{change:t.getDepartmentId},model:{value:t.departmentIds,callback:function(e){t.departmentIds=e},expression:"departmentIds"}})],1)],1),t._v(" "),i("div",{staticClass:"el-col fixed-width"},[i("el-form-item",{attrs:{label:"催收员",prop:"staffId"}},[i("el-select",{attrs:{placeholder:"请选择催收员",clearable:""},model:{value:t.conditionForm.staffId,callback:function(e){t.$set(t.conditionForm,"staffId",e)},expression:"conditionForm.staffId"}},t._l(t.staffs,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),i("div",{staticClass:"el-col fixed-width"},[i("el-form-item",{attrs:{label:"外访申请时间",prop:"applyTime"}},[i("el-date-picker",{attrs:{type:"daterange",format:"yyyy/MM/dd","value-format":"yyyy-MM-dd","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:""},on:{change:t.applyTimeChange},model:{value:t.applyTime,callback:function(e){t.applyTime=e},expression:"applyTime"}})],1)],1),t._v(" "),i("div",{staticClass:"el-col fixed-width"},[i("el-form-item",{attrs:{label:"外访编号",prop:"visitCode"}},[i("el-input",{attrs:{clearable:"",placeholder:"请输入外访编号",type:"number"},model:{value:t.conditionForm.visitCode,callback:function(e){t.$set(t.conditionForm,"visitCode",e)},expression:"conditionForm.visitCode"}})],1)],1),t._v(" "),i("div",{staticClass:"el-col fixed-width"},[i("el-form-item",{attrs:{label:"案件编号",prop:"caseCode"}},[i("el-input",{attrs:{clearable:"",placeholder:"请输入案件编号"},model:{value:t.conditionForm.caseCode,callback:function(e){t.$set(t.conditionForm,"caseCode",e)},expression:"conditionForm.caseCode"}})],1)],1),t._v(" "),i("div",{staticClass:"el-col fixed-width form-btns"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.search}},[t._v("搜索")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:t.reset}},[t._v("重置")])],1)]),t._v(" "),i("div",{staticStyle:{clear:"both"}},[i("my-table",{attrs:{tb:t.tb,loading:t.loading},on:{choose:t.handleSelectionChange}})],1),t._v(" "),i("el-pagination",{attrs:{small:"","current-page":t.conditionForm.currentPage,"page-size":t.conditionForm.pageSize,layout:"sizes,total, prev, pager, next,jumper","page-sizes":[15,50,100],total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.conditionForm,"currentPage",e)},"size-change":t.changeSize}})],1),t._v(" "),t.detailShow?i("visit-detail",{attrs:{detailShow:t.detailShow,taskId:t.taskId},on:{closeDetail:t.closeDetail}}):t._e(),t._v(" "),t.allotVisitShow?i("allot-visit",{attrs:{selected:t.selected,allotShow:t.allotVisitShow,departments:t.departments},on:{allotClose:t.allotClose,refreshList:t.refreshList}}):t._e()],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"md-left"},[e("h5",[this._v("外访管理")])])}]};var u=i("vSla")(p,m,!1,function(t){i("ZhfV")},null,null);e.default=u.exports}});