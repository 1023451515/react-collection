webpackJsonp([48],{d0N2:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("HzJ8"),i=o.n(a),r={data:function(){return{dropdownData:{},dialogFormVisible:!1,workForm:{content:"",email:"",files:[],priority:"",questionType:""},formData:{},progress:0}},created:function(){this.getdropdownData()},methods:{openDialog:function(e){this.workForm.questionType=e.code,this.workForm.questionTypeName=e.name,this.dialogFormVisible=!0},getdropdownData:function(){var e=this;this.$axios.post("/api/assignee/workOrder/getInitValues",{}).then(function(t){0==t.data.code?e.dropdownData=t.data.data:util.failCallback(t.data,e)}).catch(function(e){})},uploadImg:function(){var e=document.getElementById("logo_img").files;if(e&&e.length){var t=!0,o=!1,a=void 0;try{for(var r,l=i()(e);!(t=(r=l.next()).done);t=!0){var s=r.value;if(s.size/1024/1024>8)return this.$message.error("文件不能大于2M"),!1;this.workForm.files.push(s)}}catch(e){o=!0,a=e}finally{try{!t&&l.return&&l.return()}finally{if(o)throw a}}}},deleteFile:function(e){this.workForm.files.splice(e,1)},dialogSubmitHandle:function(){var e=this;this.$refs.workForm.validate(function(t){if(t){if(e.workForm.files.length>5)return e.$message.warning("文件数量最多为5"),!1;e.formData=new FormData;var o=!0,a=!1,r=void 0;try{for(var l,s=i()(e.workForm.files);!(o=(l=s.next()).done);o=!0){var n=l.value;e.formData.append("files",n)}}catch(e){a=!0,r=e}finally{try{!o&&s.return&&s.return()}finally{if(a)throw r}}e.formData.append("content",e.workForm.content),e.formData.append("email",e.workForm.email),e.formData.append("priority",e.workForm.priority),e.formData.append("questionType",e.workForm.questionType),e.$axios.post("/api/assignee/workOrder/submitWorkOrder",e.formData).then(function(t){0==t.data.code?(e.$message({type:"success",message:"保存成功"}),e.dialogCloseHandle()):e.$util.failCallback(t.data,e)}).catch(function(e){})}})},dialogCloseHandle:function(){this.dialogFormVisible=!1,this.$refs.workForm.resetFields(),this.workForm.files=[],document.getElementById("logo_img").value=[]}}},l={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"content-body"},[e._m(0),e._v(" "),o("div",{staticClass:"bd-main"},[e._l(e.dropdownData.questionList,function(t){return o("div",{key:t.code,staticClass:"work-md",on:{click:function(o){e.openDialog(t)},"":function(e){}}},[e._v("\n        "+e._s(t.name)+"\n      ")])}),e._v(" "),o("el-dialog",{attrs:{title:"提交工单",visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.dialogCloseHandle}},[o("el-form",{ref:"workForm",staticClass:"dialog-main",attrs:{model:e.workForm,"label-width":"100px",size:"small"}},[o("el-form-item",{attrs:{label:"工单类型",prop:"questionTypeName"}},[o("el-input",{attrs:{"auto-complete":"off",disabled:"",size:"small"},model:{value:e.workForm.questionTypeName,callback:function(t){e.$set(e.workForm,"questionTypeName",t)},expression:"workForm.questionTypeName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"优先级",prop:"priority",rules:[{required:!0,message:"必填项",trigger:"change,blur"}]}},[o("el-radio-group",{model:{value:e.workForm.priority,callback:function(t){e.$set(e.workForm,"priority",t)},expression:"workForm.priority"}},e._l(e.dropdownData.priorityList,function(t){return o("el-radio",{key:t.id,attrs:{label:t.code}},[e._v(e._s(t.name))])}))],1),e._v(" "),o("el-form-item",{attrs:{label:"问题描述",prop:"content",rules:[{required:!0,message:"必填项",trigger:"change,blur"}]}},[o("el-input",{attrs:{type:"textarea","auto-complete":"off",clearable:"",placeholder:"请输入问题描述"},model:{value:e.workForm.content,callback:function(t){e.$set(e.workForm,"content",t)},expression:"workForm.content"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"邮箱",prop:"email",rules:[{required:!0,message:"必填项",trigger:"change,blur"}]}},[o("el-input",{attrs:{"auto-complete":"off",clearable:"",placeholder:"请输入邮箱"},model:{value:e.workForm.email,callback:function(t){e.$set(e.workForm,"email",t)},expression:"workForm.email"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"附件",prop:"files",rules:[{required:!0,message:"必填项",trigger:"change,blur"}]}},[o("a",{staticClass:"a-upload",attrs:{href:"javascript:;"}},[o("input",{attrs:{type:"file",name:"files",id:"logo_img",title:"",multiple:"",clearable:""},on:{change:e.uploadImg}}),e._v("上传附件\n            ")]),e._v(" "),o("ul",{attrs:{id:"fileName"}},e._l(e.workForm.files,function(t,a){return o("li",{key:t.id,staticClass:"fileName el-upload-list__item is-finished",attrs:{index:a}},[e._v(e._s(t.name)+"\n                "),o("i",{staticClass:"el-icon-close",on:{click:function(t){e.deleteFile(a)}}})])})),e._v(" "),o("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],model:{value:e.workForm.files[0],callback:function(t){e.$set(e.workForm.files,0,t)},expression:"workForm.files[0]"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog_submit"},[o("el-button",{attrs:{size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.dialogCloseHandle(t)}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.dialogSubmitHandle(t)}}},[e._v("提 交")])],1)],1)],2)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"bd-top"},[t("div",{staticClass:"md clearfix"},[t("div",{staticClass:"md-left"},[t("h5",[this._v("提交工单")])]),this._v(" "),t("div",{staticClass:"md-right"})])])}]};var s=o("vSla")(r,l,!1,function(e){o("hKEP")},null,null);t.default=s.exports},hKEP:function(e,t){}});