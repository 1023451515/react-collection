webpackJsonp([15],{"/o4l":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={components:{},name:"add",data:function(){return{createForm:{orgName:"",description:"",orgType:"",parentId:"",functionType:""},rules:{orgName:[{required:!0,message:"部门名称不能为空",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 5 个字符",trigger:"blur"}],description:[{required:!0,message:"部门描述不能为空",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],orgType:[{required:!0,message:"部门描述不能为空",trigger:"blur"}]},functionTypeShow:!1}},props:{Dialog:{type:Boolean},dialogList:{},selectList:{},nodeData:{}},created:function(){},methods:{orgTypeChange:function(e){this.functionTypeShow="DEPARTMENT"==e},submitDialog:function(e){var t=this;this.createForm.parentId=this.nodeData.id,this.$refs.createForm.validate(function(i){i&&t.$axios.post("/api/assignee/organization/create",t.createForm).then(function(i){0==i.data.code?(t.$message({type:"success",message:i.data.msg}),t.close(e)):t.$util.failCallback(i.data,_this)})})},resetForm:function(e){this.$refs.createForm.resetFields(),this.$emit("close")},close:function(e){this.$emit("close"),this.$refs.createForm.resetFields(),this.functionTypeShow=!1}},computed:{dialog:{get:function(){return this.Dialog},set:function(){this.$emit("Dialog",this.Dialog)}}}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"添加部门","close-on-click-modal":!1,dialogList:e.dialogList,selectList:e.selectList,nodeData:e.nodeData,width:"30%","show-close":!0,visible:e.dialog,center:!0},on:{"update:visible":function(t){e.dialog=t},close:e.close}},[i("el-form",{ref:"createForm",staticClass:"dialog-main",attrs:{rules:e.rules,"label-width":"100px",model:e.createForm,size:"small"}},[i("el-form-item",{attrs:{label:"部门名称",prop:"orgName"}},[i("el-input",{attrs:{placeholder:"",clearable:""},model:{value:e.createForm.orgName,callback:function(t){e.$set(e.createForm,"orgName",t)},expression:"createForm.orgName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"部门描述",prop:"description"}},[i("el-input",{attrs:{placeholder:"",clearable:""},model:{value:e.createForm.description,callback:function(t){e.$set(e.createForm,"description",t)},expression:"createForm.description"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"部门类型",prop:"orgType"}},[i("el-select",{attrs:{placeholder:"请选择",clearable:""},on:{change:e.orgTypeChange},model:{value:e.createForm.orgType,callback:function(t){e.$set(e.createForm,"orgType",t)},expression:"createForm.orgType"}},e._l(e.selectList,function(e){return i("el-option",{key:e.id,attrs:{label:e.dictItemName,value:e.dictItemCode}})}))],1),e._v(" "),e.functionTypeShow?i("el-form-item",{attrs:{label:"预测式外呼",prop:"functionType",rules:[{required:!0,message:"请选择",trigger:"change,blur"}]}},[i("el-radio",{attrs:{label:"1"},model:{value:e.createForm.functionType,callback:function(t){e.$set(e.createForm,"functionType",t)},expression:"createForm.functionType"}},[e._v("是")]),e._v(" "),i("el-radio",{attrs:{label:"0"},model:{value:e.createForm.functionType,callback:function(t){e.$set(e.createForm,"functionType",t)},expression:"createForm.functionType"}},[e._v("否")])],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"上级部门",prop:""}},[i("el-input",{attrs:{placeholder:"",disabled:"",clearable:""},model:{value:e.nodeData.orgName,callback:function(t){e.$set(e.nodeData,"orgName",t)},expression:"nodeData.orgName"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog_submit"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.resetForm(e.createForm)}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.submitDialog(e.createForm)}}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var r={components:{addDialog:i("vSla")(a,o,!1,function(e){i("L7p0")},"data-v-51b3311b",null).exports},data:function(){return{editform:{},nodeData:{orgType:"",parentOrgName:"",id:""},selectList:[],tree:{data:[]},editrules:{description:[{required:!0,message:"部门描述不能为空",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}]},defaultProps:{children:"children",label:"orgName"},treeExpandArr:[],selectLength:0,operationBtns:[{name:"查看",identifier:"assignee_department_search",isShow:!0},{name:"添加新部门",identifier:"assignee_department_create",dialog:{dialogFormVisible:!1,form:{description:"",identifier:"",name:""},rule:{},formName:"createForm",url:"/api/assignee/organization/create",title:"添加新部门"},isShow:!0},{name:"保存",identifier:"assignee_department_update",dialog:{dialogFormVisible:!1,form:{id:null,description:"",identifier:"",name:""},rule:{},formName:"editForm",url:"/api/assignee/organization/update",title:"修改权限"},isShow:!0},{name:"删除",identifier:"assignee_department_delete",form:{id:"",identifier:""},url:"/api/assignee/organization/delete",isShow:!0}],addDepartDialog:!1,editShow:!1,treeLoading:!1,deleteLoading:!1,saveloading:!1}},created:function(){this.getList(),this.treeLoading=!0;var e={identifier:this.$route.path.slice(1)};this.$util.getPageResourceByMenu(e,this),this.operationBtns[0].isShow||this.$router.push({path:"/noAuthority"})},methods:{getList:function(){var e=this;this.treeLoading=!0,this.$axios.post("/api/assignee/organization/getAll",{}).then(function(t){e.treeLoading=!1,0==t.data.code?(t.data.data.forEach(function(t){e.treeExpandArr.push(t.id)}),e.tree.data=t.data.data,e.selectLength=0):e.$util.failCallback(t.data,e)},function(t){e.treeLoading=!1})},openCreateDialog:function(e){var t=this;void 0!==this.$refs[e.dialog.formName]&&this.$refs[e.dialog.formName].resetFields(),0==this.selectLength?this.$alert("请选择一条记录进行操作！","提示",{confirmButtonText:"确定"}):"createForm"==e.dialog.formName&&this.$axios.post("/api/assignee/organization/getChildOrgTypes",{dictItemCode:this.nodeData.orgType}).then(function(i){0==i.data.code?(t.selectList=i.data.data,0==i.data.data.length?t.$alert("当前所选已经是部门等级，无需添加部门","提示",{confirmButtonText:"确定"}):e.dialog.dialogFormVisible=!0):t.$util.failCallback(i.data,_this)},function(e){}).catch(function(e){})},closeDepartDialog:function(){this.operationBtns[1].dialog.dialogFormVisible=!1,this.getList()},handleNodeClick:function(e){this.editShow=!0,this.editform=e,this.selectLength=1,this.nodeData.orgType=e.orgType,this.nodeData.orgName=e.orgName,this.nodeData.id=e.id;this.$refs.editform.clearValidate()},deleteSubmit:function(e){var t=this,i=this;0==this.selectLength?this.$alert("请选择一条记录进行操作！","提示",{confirmButtonText:"确定",type:"warning"}):this.$alert("删除后该部门所属案件会自动转入上级部门，确定删除所选项？","提示",{confirmButtonText:"确定",type:"warning"}).then(function(){i.deleteLoading=!0,i.$axios.post("/api/assignee/organization/delete",{id:i.editform.id}).then(function(e){i.deleteLoading=!1,0==e.data.code?(i.$message({type:"success",message:e.data.msg}),i.getList(),i.editShow=!1):t.$util.failCallback(e.data,i)},function(e){}).catch(function(e){})})},saveSubmit:function(e){var t=this;this.$refs.editform.validate(function(e){e&&(t.saveloading=!0,t.$axios.post("/api/assignee/organization/update",t.editform).then(function(e){t.saveloading=!1,0==e.data.code?(t.$message({type:"success",message:e.data.msg}),t.getList()):t.$util.failCallback(e.data,t)},function(e){}))})},initializ:function(){this.editShow=!1,this.getList()},handleChangeClick:function(){}}},n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"content-body"},[e._m(0),e._v(" "),i("div",{staticClass:"bd-main",attrs:{clearfix:""}},[i("div",{staticClass:"main-left tree-wrap"},[i("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"departTree",attrs:{"tooltip-effect":"dark","element-loading-text":"拼命加载中","default-expand-all":"",data:e.tree.data,props:e.defaultProps,"node-key":"id","expand-on-click-node":!1,"highlight-current":""},on:{"current-change":e.handleChangeClick,"node-click":e.handleNodeClick}})],1),e._v(" "),i("div",{staticClass:"main-right"},[i("div",{staticClass:"mb-20"},[e.operationBtns[1].isShow?i("el-button",{attrs:{size:"mini",plain:""},on:{click:function(t){e.openCreateDialog(e.operationBtns[1])}}},[e._v(e._s(e.operationBtns[1].name))]):e._e(),e._v(" "),e.operationBtns[3].isShow?i("el-button",{attrs:{size:"mini",plain:"",loading:e.deleteLoading},on:{click:function(t){e.deleteSubmit(e.operationBtns[3])}}},[e._v(e._s(e.operationBtns[3].name))]):e._e()],1),e._v(" "),e.editShow?i("div",[i("el-form",{ref:"editform",attrs:{model:e.editform,"label-width":"100px",size:"mini",rules:e.editrules,"label-position":"left"}},[i("el-form-item",{attrs:{label:"机构类型",prop:"orgTypeName"}},[i("el-input",{attrs:{disabled:""},model:{value:e.editform.orgTypeName,callback:function(t){e.$set(e.editform,"orgTypeName",t)},expression:"editform.orgTypeName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"部门名称",prop:"orgName"}},[i("el-input",{attrs:{disabled:""},model:{value:e.editform.orgName,callback:function(t){e.$set(e.editform,"orgName",t)},expression:"editform.orgName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"部门描述",prop:"description"}},[i("el-input",{attrs:{clearable:""},model:{value:e.editform.description,callback:function(t){e.$set(e.editform,"description",t)},expression:"editform.description"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"上级部门",prop:"parentOrgName"}},[i("el-input",{attrs:{disabled:""},model:{value:e.editform.parentOrgName,callback:function(t){e.$set(e.editform,"parentOrgName",t)},expression:"editform.parentOrgName"}})],1),e._v(" "),i("el-form-item",[e.operationBtns[2].isShow?i("el-button",{attrs:{size:"mini",type:"primary",loading:e.saveloading},on:{click:function(t){e.saveSubmit(e.operationBtns[2])}}},[e._v(e._s(e.operationBtns[2].name))]):e._e(),e._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.initializ()}}},[e._v("取消")])],1)],1)],1):e._e()])])]),e._v(" "),i("addDialog",{attrs:{Dialog:e.operationBtns[1].dialog.dialogFormVisible,dialogList:e.operationBtns[1].dialog,selectList:e.selectList,nodeData:e.nodeData},on:{close:e.closeDepartDialog}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"bd-top"},[t("div",{staticClass:"md clearfix"},[t("div",{staticClass:"md-left"},[t("h5",[this._v("部门管理")])]),this._v(" "),t("div",{staticClass:"md-right"})])])}]};var s=i("vSla")(r,n,!1,function(e){i("tsyR")},null,null);t.default=s.exports},L7p0:function(e,t){},tsyR:function(e,t){}});